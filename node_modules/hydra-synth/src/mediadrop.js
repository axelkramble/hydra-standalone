
module.exports = function mediainit(){
	let editor = document.querySelector("#editor-container")

	let promise = new Promise(function(resolve, reject){
		function handleupload(e){
			e.stopPropagation();
			e.preventDefault();
			
			editor.removeEventListener('drop', handleupload);
			
			let file = e.dataTransfer.files[0];

			// just video or images
			
			if(file.type.startsWith("image")){
				
				let img = document.createElement("img")
				img.file = file

				let reader = new FileReader()
				reader.onload = function(aimg){
					return function(e){
						aimg.src = e.target.result
					}
				}(img)
				reader.readAsDataURL(file)
				console.log("IMG", img)
				resolve({ src: img, dynamic: false})

			}else if(file.type.startsWith("video")){
				let vid = document.createElement("video")
				vid.file = file
				let reader = new FileReader()
				reader.onload = function(avid){
					return function(e){
						avid.src = e.target.result
					}
				}(vid)
				reader.readAsDataURL(file)
				vid.loop = true;
				vid.play()
				resolve({ src: vid})
			}else{
				reject("check type of file")
			}
		}

		editor.addEventListener('drop', handleupload, false);
	})
	return promise
}
